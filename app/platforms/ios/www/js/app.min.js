!function(a){function b(a){var b="01",c={};for(var d in a){var e=parseInt(b,2);c[a[d]]={bitMask:e,title:a[d]},b=(e<<1).toString(2)}return c}function c(a,b){var c={};for(var d in a)if("string"==typeof a[d])if("*"==a[d]){var e="";for(var f in b)e+="1";c[d]={bitMask:parseInt(e,2)}}else console.log("Access Control Error: Could not parse '"+a[d]+"' as access definition for level '"+d+"'");else{var e=0;for(var f in a[d])b.hasOwnProperty(a[d][f])?e|=b[a[d][f]].bitMask:console.log("Access Control Error: Could not find role '"+a[d][f]+"' in registered roles while building access for '"+d+"'");c[d]={bitMask:e}}return c}var d={roles:["public","user","admin"],accessLevels:{"public":"*",anon:["public"],user:["user","admin"],admin:["admin"]}};a.userRoles=b(d.roles),a.accessLevels=c(d.accessLevels,a.userRoles)}("undefined"==typeof exports?this.routingConfig={}:exports);var app=angular.module("PHR",["ngAnimate","ngRoute","ngAria","ngTouch","ui.router","mobile-angular-ui","LocalStorageModule","highcharts-ng","appServices","appControllers","appDirectives","appFilters"]).constant("API",{URL:"http://uat.secondopinionexpert.com/phrbeta",URL_PATIENTS:"http://uat.secondopinionexpert.com/phrbeta/api/pt/patients",HEADERS:{"Content-Type":"application/x-www-form-urlencoded"}}).constant("RELATIONSHIPS",[{name:"Relationship to you",is_disabled:1},{name:"Self"},{name:"Spouse"},{name:"Son"},{name:"Daughter"},{name:"Living Partner"},{name:"Father"},{name:"Mother"},{name:"Brother"},{name:"Sister"},{name:"Uncle"},{name:"Aunt"},{name:"Cousin"},{name:"Caretaker"},{name:"Friend"},{name:"Grandfather"},{name:"Grandmother"},{name:"Legal Guardian"},{name:"Other"}]).constant("ADDRESS",{COUNTRIES:[{name:"Country",is_disabled:1},{name:"United States"},{name:"Afghanistan"},{name:"Aland Islands"},{name:"Albania"},{name:"Algeria"},{name:"American Samoa"},{name:"Andorra"},{name:"Angola"},{name:"Anguilla"},{name:"Antarctica"},{name:"Antigua and Barbuda"},{name:"Argentina"},{name:"Armenia"},{name:"Aruba"},{name:"Australia"},{name:"Austria"},{name:"Azerbaijan"},{name:"Bahamas"},{name:"Bahrain"},{name:"Bangladesh"},{name:"Barbados"},{name:"Belarus"},{name:"Belgium"},{name:"Belize"},{name:"Benin"},{name:"Bermuda"},{name:"Bhutan"},{name:"Bolivia, Plurinational State of"},{name:"Bonaire, Sint Eustatius and Saba"},{name:"Bosnia and Herzegovina"},{name:"Botswana"},{name:"Bouvet Island"},{name:"Brazil"},{name:"British Indian Ocean Territory"},{name:"Brunei Darussalam"},{name:"Bulgaria"},{name:"Burkina Faso"},{name:"Burundi"},{name:"Cambodia"},{name:"Cameroon"},{name:"Canada"},{name:"Cape Verde"},{name:"Cape Verde"},{name:"Cayman Islands"},{name:"Central African Republic"},{name:"Chad"},{name:"Chile"},{name:"China"},{name:"Christmas Island"},{name:"Cocos (Keeling) Islands"},{name:"Colombia"},{name:"Comoros"},{name:"Congo"},{name:"Congo, The Democratic Republic of the"},{name:"Cook Islands"},{name:"Costa Rica"},{name:"Cote d'Ivoire"},{name:"Croatia"},{name:"Cuba"},{name:"Curacao"},{name:"Cyprus"},{name:"Czech Republic"},{name:"Denmark"},{name:"Djibouti"},{name:"Dominica"},{name:"Dominican Republic"},{name:"Ecuador"},{name:"Egypt"},{name:"El Salvador"},{name:"Equatorial Guinea"},{name:"Eritrea"},{name:"Estonia"},{name:"Ethiopia"},{name:"Falkland Islands (Malvinas)"},{name:"Faroe Islands"},{name:"Fiji"},{name:"Finland"},{name:"France"},{name:"French Guiana"},{name:"French Polynesia"},{name:"French Southern Territories"},{name:"Gabon"},{name:"Gambia"},{name:"Georgia"},{name:"Germany"},{name:"Ghana"},{name:"Gibraltar"},{name:"Greece"},{name:"Greenland"},{name:"Grenada"},{name:"Guadeloupe"},{name:"Guam"},{name:"Guatemala"},{name:"Guernsey"},{name:"Guinea"},{name:"Guinea-Bissau"},{name:"Guyana"},{name:"Haiti"},{name:"Heard Island and McDonald Islands"},{name:"Holy See (Vatican City State)"},{name:"Honduras"},{name:"Hong Kong"},{name:"Hungary"},{name:"Iceland"},{name:"India"},{name:"Indonesia"},{name:"Iran, Islamic Republic of"},{name:"Iraq"},{name:"Ireland"},{name:"Isle of Man"},{name:"Israel"},{name:"Italy"},{name:"Jamaica"},{name:"Japan"},{name:"Jersey"},{name:"Jordan"},{name:"Kazakhstan"},{name:"Kenya"},{name:"Kiribati"},{name:"Korea, Democratic People's Republic of"},{name:"Korea, Republic of"},{name:"Kuwait"},{name:"Kyrgyzstan"},{name:"Lao People's Democratic Republic"},{name:"Latvia"},{name:"Lebanon"},{name:"Lesotho"},{name:"Liberia"},{name:"Libyan Arab Jamahiriya"},{name:"Liechtenstein"},{name:"Lithuania"},{name:"Luxembourg"},{name:"Macao"},{name:"Macedonia, The former Yugoslav Republic of"},{name:"Madagascar"},{name:"Malawi"},{name:"Malaysia"},{name:"Maldives"},{name:"Mali"},{name:"Malta"},{name:"Marshall Islands"},{name:"Martinique"},{name:"Mauritania"},{name:"Mauritius"},{name:"Mayotte"},{name:"Mexico"},{name:"Micronesia, Federated States of"},{name:"Moldova, Republic of"},{name:"Monaco"},{name:"Mongolia"},{name:"Montenegro"},{name:"Montserrat"},{name:"Morocco"},{name:"Mozambique"},{name:"Myanmar"},{name:"Namibia"},{name:"Nauru"},{name:"Nepal"},{name:"Netherlands"},{name:"New Caledonia"},{name:"New Zealand"},{name:"Nicaragua"},{name:"Niger"},{name:"Nigeria"},{name:"Niue"},{name:"Norfolk Island"},{name:"Northern Mariana Islands"},{name:"Norway"},{name:"Oman"},{name:"Pakistan"},{name:"Palau"},{name:"Palestinian Territory, Occupied"},{name:"Panama"},{name:"Papua New Guinea"},{name:"Paraguay"},{name:"Peru"},{name:"Philippines"},{name:"Pitcairn"},{name:"Poland"},{name:"Portugal"},{name:"Puerto Rico"},{name:"Qatar"},{name:"Reunion"},{name:"Romania"},{name:"Russian Federation"},{name:"Rwanda"},{name:"Saint Barthelemy"},{name:"Saint Helena, Ascension and Tristan Da Cunha"},{name:"Saint Kitts and Nevis"},{name:"Saint Lucia"},{name:"Saint Martin (French Part)"},{name:"Saint Pierre and Miquelon"},{name:"Saint Vincent and The Grenadines"},{name:"Samoa"},{name:"San Marino"},{name:"Sao Tome and Principe"},{name:"Saudi Arabia"},{name:"Senegal"},{name:"Serbia"},{name:"Seychelles"},{name:"Sierra Leone"},{name:"Singapore"},{name:"Sint Maarten (Dutch Part)"},{name:"Slovakia"},{name:"Slovenia"},{name:"Solomon Islands"},{name:"Somalia"},{name:"South Africa"},{name:"South Georgia and The South Sandwich Islands"},{name:"South Sudan"},{name:"Spain"},{name:"Sri Lanka"},{name:"Sudan"},{name:"Suriname"},{name:"Svalbard and Jan Mayen"},{name:"Swaziland"},{name:"Sweden"},{name:"Switzerland"},{name:"Syrian Arab Republic"},{name:"Taiwan, Province of China"},{name:"Tajikistan"},{name:"Tanzania, United Republic of"},{name:"Thailand"},{name:"Timor-Leste"},{name:"Togo"},{name:"Tokelau"},{name:"Tonga"},{name:"Trinidad and Tobago"},{name:"Tunisia"},{name:"Turkey"},{name:"Turkmenistan"},{name:"Turks and Caicos Islands"},{name:"Tuvalu"},{name:"Uganda"},{name:"Ukraine"},{name:"United Arab Emirates"},{name:"United Kingdom"},{name:"United States Minor Outlying Islands"},{name:"Uruguay"},{name:"Uzbekistan"},{name:"Vanuatu"},{name:"Venezuela, Bolivarian Republic of"},{name:"Viet Nam"},{name:"Virgin Islands, British"},{name:"Virgin Islands, U.S."},{name:"Wallis and Futuna"},{name:"Western Sahara"},{name:"Yemen"},{name:"Zambia"},{name:"Zimbabwe"}],STATES:[{name:"State",is_disabled:1},{name:"Alabama"},{name:"Alaska"},{name:"Arizona"},{name:"Arkansas"},{name:"California"},{name:"Colorado"},{name:"Connecticut"},{name:"Delaware"},{name:"District of Columbia"},{name:"Florida"},{name:"Georgia"},{name:"Hawaii"},{name:"Idaho"},{name:"Illinois"},{name:"Indiana"},{name:"Iowa"},{name:"Kansas"},{name:"Kentucky"},{name:"Louisiana"},{name:"Maine"},{name:"Maryland"},{name:"Massachusetts"},{name:"Michigan"},{name:"Minnesota"},{name:"Mississippi"},{name:"Missouri"},{name:"Montana"},{name:"Nebraska"},{name:"Nevada"},{name:"New Hampshire"},{name:"New Jersey"},{name:"New Mexico"},{name:"New York"},{name:"North Carolina"},{name:"North Dakota"},{name:"Ohio"},{name:"Oklahoma"},{name:"Pennsylvania"},{name:"Rhode Island"},{name:"South Carolina"},{name:"South Dakota"},{name:"Tennessee"},{name:"Texas"},{name:"Utah"},{name:"Vermont"},{name:"Virginia"},{name:"Washington"},{name:"West Virginia"},{name:"Wisconsin"},{name:"Wyoming"}]}).config(["$sceDelegateProvider","$routeProvider","$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","API",function(a,b,c,d,e,f){a.resourceUrlWhitelist(["self","http://soeweb1.cloudapp.net/**","http://uat.secondopinionexpert.com/**"]),f.interceptors.push("authHttpResponseInterceptor");var g=routingConfig.accessLevels,h=["views","sign-up","measurements","histories","summaries","profile","documents","common","share"];c.state("anon",{"abstract":!0,template:"<div ui-view/>",data:{access:g.anon}}).state("anon.indexdefault",{url:"",templateUrl:h[0]+"/index.html"}).state("anon.index",{url:"/",templateUrl:h[0]+"/index.html"}).state("anon.login",{url:"/login",templateUrl:h[0]+"/login.html",controller:"LoginCtrl"}).state("anon.register",{url:"/sign-up",templateUrl:h[0]+"/"+h[1]+"/sign-up.html",controller:"SignupCtrl"}).state("anon.thanks",{url:"/sign-up-thanks",templateUrl:h[0]+"/"+h[1]+"/thanks.html"}).state("anon.signupconfirmation",{url:"/sign-up-confirmation/:token",templateUrl:h[0]+"/"+h[1]+"/sign-up-confirmation.html",controller:"SignupConfirmationCtrl"}).state("anon.forgotpassword",{url:"/forgot-password",templateUrl:h[0]+"/forgot-password.html",controller:"ForgotPasswordCtrl"}).state("anon.forgotpasswordconfirmation",{url:"/forgot-password-confirmation/:token",templateUrl:h[0]+"/forgot-password-confirmation.html",controller:"ForgotPasswordConfirmationCtrl"}),c.state("user",{"abstract":!0,template:"<ui-view/>",data:{access:g.user}}).state("user.accounts",{url:"/accounts",templateUrl:h[0]+"/"+h[7]+"/accounts.html",controller:"AccountsCtrl",data:{isSignUp:0,loggedin:1}}).state("user.accounts-switcher",{url:"/accounts-switcher",templateUrl:h[0]+"/"+h[7]+"/accounts.html",controller:"AccountsCtrl",data:{isSignUp:1,loggedin:0}}).state("user.add-a-person",{url:"/add-a-person",templateUrl:h[0]+"/"+h[7]+"/add-a-person.html",controller:"AccountsCtrl"}).state("user.home",{url:"/home",templateUrl:h[0]+"/home.html",controller:"HomeCtrl"}).state("user.logout",{url:"/logout",templateUrl:h[0]+"/index.html",controller:"LogoutCtrl"}).state("user.changepassword",{url:"/change-password",templateUrl:h[0]+"/change-password.html",controller:"ChangePasswordCtrl"}).state("user.signup",{"abstract":!0,url:"/"+h[1],template:"<div ui-view/>"}).state("user.signup.terms",{url:"/terms",templateUrl:h[0]+"/"+h[1]+"/terms.html",controller:"TermsCtrl"}).state("user.signup.sign",{url:"/sign",templateUrl:h[0]+"/"+h[1]+"/sign.html",controller:"SignCtrl"}).state("user.signup.basic-information",{url:"/basic-information",templateUrl:h[0]+"/"+h[1]+"/basic-information.html",controller:"BasicInformationCtrl",data:{is_add_account:0,isSignUp:1}}).state("user.signup.basic-question",{url:"/basic-question",templateUrl:h[0]+"/"+h[1]+"/basic-question.html",controller:"BasicQuestionCtrl",data:{is_add_account:0,isSignUp:1}}).state("user.signup.work-address",{url:"/work-address",templateUrl:h[0]+"/"+h[1]+"/work-address.html",controller:"AddressCtrl"}).state("user.signup.home-address",{url:"/home-address",templateUrl:h[0]+"/"+h[1]+"/home-address.html",controller:"AddressCtrl"}).state("user.signup.contact-info",{url:"/contact-info",templateUrl:h[0]+"/"+h[1]+"/contact-info.html",controller:"ContactInfoCtrl",data:{is_add_account:0}}).state("user.add-account",{"abstract":!0,url:"/add-account",template:"<div ui-view/>"}).state("user.add-account.basic-information",{url:"/basic-information",templateUrl:h[0]+"/"+h[1]+"/basic-information.html",controller:"BasicInformationCtrl",data:{is_add_account:1}}).state("user.add-account.basic-question",{url:"/basic-question",templateUrl:h[0]+"/"+h[1]+"/basic-question.html",controller:"BasicQuestionCtrl",data:{is_add_account:1}}).state("user.add-account.contact-info",{url:"/contact-info",templateUrl:h[0]+"/"+h[1]+"/contact-info.html",controller:"ContactInfoCtrl",data:{is_add_account:1}}).state("user.signup.measurements",{url:"/measurements",templateUrl:h[0]+"/"+h[1]+"/measurements.html",controller:"MeasurementsCtrl"}).state("user.signup.physician",{url:"/physician",templateUrl:h[0]+"/"+h[1]+"/physician.html",controller:"PhysicianCtrl"}).state("user.profile",{"abstract":!0,url:"/"+h[5],template:"<div ui-view/>"}).state("user.profile.personal-info",{url:"/personal-info",templateUrl:h[0]+"/"+h[1]+"/personal-info.html",controller:"PersonalInfoCtrl"}).state("user.profile.work-address",{url:"/work-address",templateUrl:h[0]+"/"+h[1]+"/work-address.html",controller:"AddressCtrl"}).state("user.profile.home-address",{url:"/home-address",templateUrl:h[0]+"/"+h[1]+"/home-address.html",controller:"AddressCtrl"}).state("user.profile.contact-info",{url:"/contact-info",templateUrl:h[0]+"/"+h[1]+"/contact-info.html",controller:"ContactInfoCtrl",data:{is_add_account:0}}).state("user.measurements",{"abstract":!0,url:"/"+h[2],template:"<div ui-view/>"}).state("user.measurements.bodySystems",{url:"/health-status",templateUrl:h[0]+"/"+h[2]+"/body-systems/body-systems.html",controller:"BodySystemsCtrl"}).state("user.measurements.allergies",{url:"/allergies",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Allergies",item:"Allergy",shortcut:"allergies",shortcutSingle:"allergy",type:h[2],icon:"fa-warning"}}).state("user.measurements.allergies-create",{url:"/allergy",templateUrl:h[0]+"/"+h[2]+"/allergies/create.html",controller:"AllergyCreateCtrl",data:{items:"Allergies",item:"Allergy",shortcut:"allergies",shortcutSingle:"allergy",type:"measurements"}}).state("user.measurements.allergies-edit",{url:"/allergy/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"AllergyEditCtrl",data:{items:"Allergies",item:"Allergy",shortcut:"allergies",shortcutSingle:"allergy",type:"measurements"}}).state("user.measurements.allergies-view",{url:"/allergy/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Allergies",item:"Allergy",shortcut:"allergies",shortcutSingle:"allergy",type:"measurements"}}).state("user.measurements.sleep",{url:"/sleeps",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Sleep",item:"Sleep",shortcut:"sleeps",shortcutSingle:"sleep",type:h[2],icon:"fa-moon-o"}}).state("user.measurements.sleep-create",{url:"/sleep",templateUrl:h[0]+"/"+h[2]+"/sleeps/create.html",controller:"SleepEditCtrl",data:{items:"Sleep",item:"Sleep",shortcut:"sleeps",shortcutSingle:"sleep",type:"measurements"}}).state("user.measurements.sleep-edit",{url:"/sleep/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"SleepEditCtrl",data:{items:"Sleep",item:"Sleep",shortcut:"sleeps",shortcutSingle:"sleep",type:"measurements"}}).state("user.measurements.sleep-view",{url:"/sleep/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Sleep",item:"Sleep",shortcut:"sleeps",shortcutSingle:"sleep",type:"measurements"}}).state("user.measurements.exercises",{url:"/exercises",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Exercises",item:"Exercise",shortcut:"exercises",shortcutSingle:"exercise",type:h[2],icon:"fa-rocket"}}).state("user.measurements.exercises-create",{url:"/exercise",templateUrl:h[0]+"/"+h[7]+"/create.html",controller:"ItemCreateCtrl",data:{items:"Exercises",item:"Exercise",shortcut:"exercises",shortcutSingle:"exercise",type:"measurements"}}).state("user.measurements.exercises-edit",{url:"/exercise/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"ExercisesEditCtrl",data:{items:"Exercises",item:"Exercise",shortcut:"exercises",shortcutSingle:"exercise",type:"measurements"}}).state("user.measurements.exercises-view",{url:"/exercise/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Exercises",item:"Exercise",shortcut:"exercises",shortcutSingle:"exercise",type:"measurements"}}).state("user.measurements.bathroom",{url:"/bathrooms",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Bathrooms",item:"Bathroom",shortcut:"bathrooms",shortcutSingle:"bathroom",type:h[2],icon:"fa-bomb"}}).state("user.measurements.bathroom-create",{url:"/bathroom",templateUrl:h[0]+"/"+h[2]+"/bathrooms/create.html",controller:"BathroomEditCtrl",data:{items:"Bathrooms",item:"Bathroom",shortcut:"bathrooms",shortcutSingle:"bathroom",type:"measurements"}}).state("user.measurements.bathroom-edit",{url:"/bathroom/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"BathroomEditCtrl",data:{items:"Bathrooms",item:"Bathroom",shortcut:"bathrooms",shortcutSingle:"bathroom",type:"measurements"}}).state("user.measurements.bathroom-view",{url:"/bathroom/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Bathrooms",item:"Bathroom",shortcut:"bathrooms",shortcutSingle:"bathroom",type:"measurements"}}).state("user.measurements.foodsdrinks",{url:"/foodsdrinks",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Foods & Drinks",item:"Food & Drink",shortcut:"foodsdrinks",shortcutSingle:"fooddrink",type:h[2],icon:"fa-cutlery"}}).state("user.measurements.foodsdrinks-create",{url:"/fooddrink",templateUrl:h[0]+"/"+h[7]+"/create.html",controller:"ItemCreateCtrl",data:{items:"Foods & Drinks",item:"Food &  Drink",shortcut:"foodsdrinks",shortcutSingle:"fooddrink",type:"measurements"}}).state("user.measurements.foodsdrinks-edit",{url:"/fooddrink/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"FoodsdrinksEditCtrl",data:{items:"Foods & Drinks",item:"Food & Drink",shortcut:"foodsdrinks",shortcutSingle:"fooddrink",type:"measurements"}}).state("user.measurements.foodsdrinks-view",{url:"/fooddrink/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Foods &  Drinks",item:"Food &  Drink",shortcut:"foodsdrinks",shortcutSingle:"fooddrink",type:"measurements"}}).state("user.measurements.immunizations",{url:"/immunizations",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Immunizations",item:"Immunization",shortcut:"immunizations",shortcutSingle:"immunization",type:h[2],icon:"fa-shield"}}).state("user.measurements.immunizations-create",{url:"/immunization",templateUrl:h[0]+"/"+h[7]+"/create.html",controller:"ItemCreateCtrl",data:{items:"Immunizations",item:"Immunization",shortcut:"immunizations",shortcutSingle:"immunization",type:"measurements"}}).state("user.measurements.immunizations-edit",{url:"/immunization/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"immunizationsEditCtrl",data:{items:"Immunizations",item:"Immunization",shortcut:"immunizations",shortcutSingle:"immunization",type:"measurements"}}).state("user.measurements.immunizations-view",{url:"/immunization/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Immunizations",item:"Immunization",shortcut:"immunizations",shortcutSingle:"immunization",type:"measurements"}}).state("user.measurements.medications",{url:"/medications",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Medications",item:"Medication",shortcut:"medications",shortcutSingle:"medication",type:h[2],icon:"fa-medkit"}}).state("user.measurements.medications-create",{url:"/medication",templateUrl:h[0]+"/"+h[2]+"/medications/create.html",controller:"MedicationCreateCtrl",data:{items:"Medications",item:"Medication",shortcut:"medications",shortcutSingle:"medication",type:"measurements"}}).state("user.measurements.medications-edit",{url:"/medication/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"MedicationsEditCtrl",data:{items:"Medications",item:"Medication",shortcut:"medications",shortcutSingle:"medication",type:"measurements"}}).state("user.measurements.medications-view",{url:"/medication/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Medications",item:"Medication",shortcut:"medications",shortcutSingle:"medication",type:"measurements"}}).state("user.measurements.heights",{url:"/heights",templateUrl:h[0]+"/"+h[2]+"/heights/list.html",controller:"HeightsCtrl"}).state("user.measurements.heights-view",{url:"/heights/:id",templateUrl:h[0]+"/"+h[2]+"/heights/view.html",controller:"HeightsViewCtrl"}).state("user.measurements.heights-edit",{url:"/heights/:id/edit",templateUrl:h[0]+"/"+h[2]+"/heights/edit.html",controller:"HeightsEditCtrl"}).state("user.measurements.heights-create",{url:"/height",templateUrl:h[0]+"/"+h[2]+"/heights/create.html",controller:"HeightsCreateCtrl"}).state("user.measurements.weights",{url:"/weights",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Weight",item:"Weight",shortcut:"weights",shortcutSingle:"weight",type:h[2],icon:"fa-dashboard"}}).state("user.measurements.weights-create",{url:"/weight",templateUrl:h[0]+"/"+h[2]+"/weights/create.html",controller:"WeightsEditCtrl",data:{items:"Weights",item:"Weight",shortcut:"weights",shortcutSingle:"weight",type:h[2]}}).state("user.measurements.weights-edit",{url:"/weight/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"WeightsEditCtrl",data:{items:"Weights",item:"Weight",shortcut:"weights",shortcutSingle:"weight",type:h[2]}}).state("user.measurements.weights-view",{url:"/weight/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Weights",item:"Weight",shortcut:"weights",shortcutSingle:"weight",type:h[2]}}).state("user.measurements.visionrx",{url:"/visionrxs",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"VisionRx",item:"VisionRx",shortcut:"visionrxs",shortcutSingle:"visionrx",type:h[2],icon:"fa-eye"}}).state("user.measurements.visionrx-create",{url:"/visionrx",templateUrl:h[0]+"/"+h[7]+"/create.html",controller:"ItemCreateCtrl",data:{items:"VisionRx",item:"VisionRx",shortcut:"visionrxs",shortcutSingle:"visionrx",type:"measurements"}}).state("user.measurements.visionrx-edit",{url:"/visionrx/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"ItemEditCtrl",data:{items:"VisionRx",item:"VisionRx",shortcut:"visionrxs",shortcutSingle:"visionrx",type:"measurements"}}).state("user.measurements.visionrx-view",{url:"/visionrx/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"VisionRx",item:"VisionRx",shortcut:"visionrxs",shortcutSingle:"visionrx",type:"measurements"}}).state("user.measurements.naturalSupplements",{url:"/natural-supplements",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Natural supplements",item:"Supplement",shortcut:"natural-supplements",shortcutSingle:"natural-supplement",type:h[2],icon:"fa-coffee"}}).state("user.measurements.naturalSupplements-create",{url:"/natural-supplement",templateUrl:h[0]+"/"+h[7]+"/create.html",controller:"ItemCreateCtrl",data:{items:"Natural supplements",item:"Natural supplements",shortcut:"natural-supplements",shortcutSingle:"natural-supplement",type:"measurements"}}).state("user.measurements.naturalSupplements-edit",{url:"/natural-supplement/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"NaturalSupplementsEditCtrl",data:{items:"Natural supplements",item:"Natural supplements",shortcut:"natural-supplements",shortcutSingle:"natural-supplement",type:"measurements"}}).state("user.measurements.naturalSupplements-view",{url:"/natural-supplement/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Natural supplements",item:"Natural supplements",shortcut:"natural-supplements",shortcutSingle:"natural-supplement",type:"measurements"}}).state("user.histories",{"abstract":!0,url:"/"+h[3],template:"<div ui-view/>"}).state("user.histories.procedures",{url:"/procedures",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Procedures",item:"Procedure",shortcut:"procedures",shortcutSingle:"procedure",type:h[3],icon:"fa-stethoscope"}}).state("user.histories.procedures-create",{url:"/procedure",templateUrl:h[0]+"/"+h[7]+"/create.html",controller:"ItemCreateCtrl",data:{items:"Procedures",item:"Procedure",shortcut:"procedures",shortcutSingle:"procedure",type:h[3]}}).state("user.histories.procedures-edit",{url:"/procedure/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"ProceduresEditCtrl",data:{items:"Procedures",item:"Procedure",shortcut:"procedures",shortcutSingle:"procedure",type:h[3]}}).state("user.histories.procedures-view",{url:"/procedure/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Procedures",item:"Procedure",shortcut:"procedures",shortcutSingle:"procedure",type:h[3]}}).state("user.histories.conditions",{url:"/conditions",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Conditions",item:"Condition",apiShortcut:"mc",shortcut:"conditions",shortcutSingle:"condition",type:h[3],icon:"fa-flag"}}).state("user.histories.conditions-create",{url:"/condition",templateUrl:h[0]+"/"+h[3]+"/conditions/create.html",controller:"ConditionCreateCtrl",data:{items:"Conditions",item:"Condition",apiShortcut:"mc",shortcut:"conditions",shortcutSingle:"condition",placeholder:"Enter a past or present condition",type:h[3]}}).state("user.histories.conditions-edit",{url:"/condition/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"ConditionsEditCtrl",data:{items:"Conditions",item:"Condition",apiShortcut:"mc",shortcut:"conditions",shortcutSingle:"condition",type:h[3]}}).state("user.histories.conditions-view",{url:"/condition/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Conditions",item:"Condition",apiShortcut:"mc",shortcut:"conditions",shortcutSingle:"condition",type:h[3]}}).state("user.histories.family",{url:"/family-histories",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Family history",item:"Family history",apiShortcut:"mc",shortcut:"family-histories",shortcutSingle:"family-history",type:h[3],icon:"fa-users"}}).state("user.histories.family-create",{url:"/family-history",templateUrl:h[0]+"/"+h[3]+"/family-histories/create.html",controller:"FamilyCreateCtrl",data:{items:"Family history",item:"Family history",apiShortcut:"mc",shortcut:"family-histories",shortcutSingle:"family-history",placeholder:"Enter a past family history",type:h[3]}}).state("user.histories.family-edit",{url:"/family-history/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"ConditionsEditCtrl",data:{items:"Family history",item:"Family history",apiShortcut:"mc",shortcut:"family-histories",shortcutSingle:"family-history",type:h[3]}}).state("user.histories.family-view",{url:"/family-history/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Family history",item:"Family history",apiShortcut:"mc",shortcut:"family-histories",shortcutSingle:"family-history",type:h[3]}}).state("user.histories.surgical",{url:"/surgical-histories",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Surgical history",item:"Surgical history",apiShortcut:"mh",shortcut:"surgical-histories",shortcutSingle:"surgical-history",type:h[3],icon:"fa-stethoscope"}}).state("user.histories.surgical-create",{url:"/surgical-history",templateUrl:h[0]+"/"+h[7]+"/create.html",controller:"ItemCreateCtrl",data:{items:"Surgical history",item:"Surgical history",apiShortcut:"mh",shortcut:"surgical-histories",shortcutSingle:"surgical-history",placeholder:"Enter a past surgical history",type:h[3]}}).state("user.histories.surgical-edit",{url:"/surgical-history/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"ConditionsEditCtrl",data:{items:"Surgical history",item:"Surgical history",apiShortcut:"mh",shortcut:"surgical-histories",shortcutSingle:"surgical-history",type:h[3]}}).state("user.histories.surgical-view",{url:"/surgical-history/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Family history",item:"Family history",apiShortcut:"mh",shortcut:"surgical-histories",shortcutSingle:"surgical-history",type:h[3]}}).state("user.histories.socialHistory",{url:"/social-history",templateUrl:h[0]+"/"+h[3]+"/social-history/edit.html",controller:"SocialHistoryCtrl"}).state("user.histories.labresults",{url:"/lab-results",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Laboratory test results",item:"Laboratory test result",shortcut:"lab-results",shortcutSingle:"lab-result",type:h[3],icon:"fa-flask"}}).state("user.histories.labresults-create",{url:"/lab-result",templateUrl:h[0]+"/"+h[7]+"/create.html",controller:"ItemCreateCtrl",data:{items:"Laboratory test results",item:"Laboratory test result",shortcut:"lab-results",shortcutSingle:"lab-result",type:h[3]}}).state("user.histories.labresults-edit",{url:"/lab-result/:id/edit",templateUrl:h[0]+"/"+h[7]+"/edit.html",controller:"LabresultsEditCtrl",data:{items:"Laboratory test results",item:"Laboratory test result",shortcut:"lab-results",shortcutSingle:"lab-result",type:h[3]}}).state("user.histories.labresults-view",{url:"/lab-result/:id",templateUrl:h[0]+"/"+h[7]+"/view.html",controller:"ItemViewCtrl",data:{items:"Laboratory test results",item:"Laboratory test result",shortcut:"lab-results",shortcutSingle:"lab-result",type:h[3]}}).state("user.health-summary",{"abstract":!0,url:"/health-summary",template:"<div ui-view/>"}).state("user.health-summary.view",{url:"/view",templateUrl:h[0]+"/"+h[4]+"/view.html",controller:"SummariesViewCrtl"}).state("user.share",{"abstract":!0,url:"/share",template:"<div ui-view/>"}).state("user.share.send",{url:"/send",templateUrl:h[0]+"/"+h[8]+"/share.html",controller:"ShareCrtl"}).state("user.share.by-me",{url:"/shared-by-me",templateUrl:h[0]+"/"+h[8]+"/shared.html",controller:"SharedCrtl",data:{title:"Shared By Me",type:"byMe"}}).state("user.share.detail-by-me",{url:"/shared-by-me/:id",templateUrl:h[0]+"/"+h[8]+"/shareddetail.html",controller:"SharedDetailCrtl",data:{type:"byMe",backurl:"#/share/shared-by-me"}}).state("user.share.detail-with-me",{url:"/shared-with-me/:id",templateUrl:h[0]+"/"+h[8]+"/shareddetail.html",controller:"SharedDetailCrtl",data:{type:"withMe",backurl:"#/share/shared-with-me"}}).state("user.share.with-me",{url:"/shared-with-me",templateUrl:h[0]+"/"+h[8]+"/shared.html",controller:"SharedCrtl",data:{type:"withMe",title:"Shared With Me",items:"Allergies",item:"Allergy",shortcut:"allergies",shortcutSingle:"allergy",icon:"fa-warning"}}).state("user.documents",{"abstract":!0,url:"/"+h[6],template:"<div ui-view/>"}).state("user.documents.list",{url:"/list",templateUrl:h[0]+"/"+h[7]+"/list.html",controller:"ItemsCtrl",data:{items:"Documents",item:"Documents",apiShortcut:"docsvault",shortcutSingle:"item",type:h[6],icon:"fa-arrow-circle-o-down",download:!0}}).state("user.documents.item-view",{url:"/item/:id",templateUrl:h[0]+"/"+h[7]+"/iframe.html",controller:"DocumentsViewCrtl"}).state("user.documents.item",{url:"/item",templateUrl:h[0]+"/"+h[6]+"/upload.html",controller:"DocumentsUploadCrtl"}).state("admin",{"abstract":!0,template:"<ui-view/>",data:{access:g.admin}}),d.otherwise("/404")}]),appControllers=angular.module("appControllers",["appServices","appFilters"]);appControllers.controller("MainController",["$rootScope","$state","$location","Auth",function(a,b,c,d){a.$on("$stateChangeStart",function(e,f,g,h){var i=f.name;a.fromState=h,a.loading=1,a.hasBottomBar=0,a.isSignUp=-1==i.search("signup")?0:1,a.requireLogin=-1==i.search("user")?0:1,console.log(a.requireLogin,d.loginExpired()),a.requireLogin&&d.loginExpired()&&(b.$current.data?d.needLogin():(e.preventDefault(),d.logout(function(){c.path("logout")}))),"data"in f&&"access"in f.data?d.authorize(f.data.access)||(a.error="Seems like you tried accessing a route you don't have access to...",e.preventDefault(),"^"===h.url&&(d.isLoggedIn()?b.go("user.home"):(a.error=null,b.go("anon.login")))):(a.error="Access undefined for this state",e.preventDefault()),console.log("Going to "+i)}),a.$on("$stateChangeSuccess",function(b,c){console.log("Route Changed"),a.loaded||(a.loaded=1),a.loading=0,d.isLoggedIn()?(a.loggedin=1,a.bodyClass=c.name):(a.loggedin=0,a.bodyClass="not-logged"),a.cancel_link=a.loggedin?"#/home":"#/"
})}]).controller("LogoutCtrl",["$scope","$state","Auth",function(a,b,c){c.logout(function(){b.go("anon.index")})}]).controller("AccountsCtrl",["$rootScope","$scope","$state","UserService","Auth",function(a,b,c,d,e){a.isSignUp=c.current.data.isSignUp,a.loggedin=c.current.data.loggedin,b.waiting=1,d.getAccounts(function(c){c.length>1?(b.accounts=c,b.waiting=0,a.loggedin=1,a.hide_switch=0):(a.hide_switch=1,b.submitForm(e.user.id))}),b.submitForm=function(a){"number"!=typeof a&&(a=b.account),e.setCurrentAccount(a,function(){c.go("user.home")},function(a){console.log(a)})}}]).controller("HomeCtrl",["$scope","$timeout","$location","Auth","ApiService","Notification",function(a,b,c,d){var e=new Date;a.user=d.user,e=e.toDateString(),a.allDone=1}]).controller("SignCtrl",["$scope","$state","Auth",function(a,b,c){a.user=c.user,a.user.sign_name="",a.submitForm=function(){c.update(a.user,function(){b.go("user.signup.basic-information")})}}]).controller("BasicInformationCtrl",["$scope","$state","$filter","Auth","RELATIONSHIPS",function(a,b,c,d,e){a.is_add_account=b.current.data.is_add_account,a.isSignUp=b.current.data.isSignUp,console.log(b.current.data),a.user=a.is_add_account?{}:d.user,a.genders=[{name:"Gender",is_disabled:1},{name:"Male"},{name:"Female"}],a.salutations=[{name:"Salutation",is_disabled:1},{name:"Mr."},{name:"Mrs."},{name:"Mis."},{name:"Miss"},{name:"Dr."},{name:"Prof."},{name:"Rev."},{name:"Other"}],a.suffixes=[{name:"Suffix",is_disabled:1},{name:"I"},{name:"II"},{name:"III"},{name:"Jr"},{name:"Sr."},{name:"Esq."}],a.MaritalStatuses=[{name:"Marital Status",is_disabled:1},{name:"Single"},{name:"Married"},{name:"Separated"},{name:"Widowed"},{name:"Divorced"}],a.maxDate=c("date")(new Date,"yyyy-MM-dd"),a.relationships=e.slice(),a.user=a.is_add_account?{}:d.user,a.user.dob=new Date(a.user.dob),a.user.gender=a.genders[a.user.gender],a.is_add_account&&a.relationships.splice(1,1),a.isSignUp||a.is_add_account?(a.btn="Continue",a.user.salutation=a.salutations[0],a.user.suffix=a.suffixes[0],a.user.maritalStatus=a.MaritalStatuses[0]):(a.btn="Save",a.user.salutation=a.salutations[a.user.salutation],a.user.suffix=a.suffixes[a.user.suffix],a.user.maritalStatus=a.MaritalStatuses[a.user.maritalStatus]),a.user.gender=a.genders[0],a.user.relationship=a.relationships[0],a.submitForm=function(){var c=angular.extend({},a.user);if(c.maritalStatus=a.MaritalStatuses.indexOf(a.user.maritalStatus),c.salutation=a.salutations.indexOf(a.user.salutation),c.suffix=a.suffixes.indexOf(a.user.suffix),c.gender=a.genders.indexOf(a.user.gender),c.relationship=a.relationships.indexOf(a.user.relationship),a.is_add_account)d.setTempAccount(c,1,function(){b.go("user.add-account.basic-question")});else{var c=angular.extend({},a.user);c.maritalStatus=a.MaritalStatuses.indexOf(a.user.maritalStatus),c.salutation=a.salutations.indexOf(a.user.salutation),c.suffix=a.suffixes.indexOf(a.user.suffix),c.gender=a.genders.indexOf(a.user.gender),c.relationship=a.relationships.indexOf(a.user.relationship),d.update(c,function(){b.go("user.signup.basic-question")},function(a){console.log(a)},1,1)}},a.$watch("user.gender",function(){a.relationshipform.sel_gender.$setValidity("selgender",a.genders.indexOf(a.user.gender)>0)}),a.relationshipSelected=function(){var b="Self"==a.user.relationship.name;a.is_self=b,a.is_not_self=!b,a.patient_selected=1},a.submitLink=a.submitForm}]).controller("BasicQuestionCtrl",["$rootScope","$state","$filter","Auth",function(a,b,c,d){a.is_add_account=b.current.data.is_add_account,a.isSignUp=b.current.data.isSignUp,a.user=a.is_add_account?d.getTempUser():d.user,a.btn=a.isSignUp||a.is_add_account?"Continue":"Save",a.submitForm=function(){if(a.is_add_account)d.setTempAccount(a.user,0,function(){b.go("user.add-account.contact-info")});else{var c=angular.extend({},a.user);d.update(c,function(){b.go(a.isSignUp?"user.signup.home-address":"user.home")},function(a){console.log(a)},a.isSignUp)}},a.submitLink=a.submitForm}]).controller("PersonalInfoCtrl",["$rootScope","$state","$filter","Auth",function(a,b,c,d){a.genders=[{name:"Gender",is_disabled:1},{name:"Male"},{name:"Female"}],a.salutations=[{name:"Salutation",is_disabled:1},{name:"Mr."},{name:"Mrs."},{name:"Mis."},{name:"Miss"},{name:"Dr."},{name:"Prof."},{name:"Rev."},{name:"Other"}],a.suffixes=[{name:"Suffix",is_disabled:1},{name:"I"},{name:"II"},{name:"III"},{name:"Jr"},{name:"Sr."},{name:"Esq."}],a.MaritalStatuses=[{name:"Marital Status",is_disabled:1},{name:"Single"},{name:"Married"},{name:"Separated"},{name:"Widowed"},{name:"Divorced"}],a.maxDate=c("date")(new Date,"yyyy-MM-dd"),a.user=d.user,a.btn="Save",a.usersuffix=a.user.suffix>0?a.suffixes[a.user.suffix]:a.suffixes[0],a.usergender=a.user.gender>0?a.genders[a.user.gender]:a.genders[0],a.userMaritalStatus=a.user.maritalStatus>0?a.MaritalStatuses[a.user.maritalStatus]:a.MaritalStatuses[0],a.usersalutation=a.user.salutation>0?a.salutations[a.user.salutation]:a.salutations[0],a.userdob=new Date(a.user.dob);var e=a.usersuffix,f=a.usersalutation,g=a.userMaritalStatus,h=a.usergender;a.selsfx=function(a){e=a},a.selsal=function(a){f=a},a.selgender=function(a){h=a},a.selmarital=function(a){g=a,console.log(userMaritalStatus)},a.submitForm=function(){var c=angular.extend({},a.user);c.maritalStatus=a.MaritalStatuses.indexOf(g),c.salutation=a.salutations.indexOf(f),c.suffix=a.suffixes.indexOf(e),c.gender=a.genders.indexOf(h),d.update(c,function(){b.go(a.isSignUp?"user.signup.work-address":"user.home")},function(a){console.log(a)},0)},a.submitLink=a.submitForm}]).controller("AddressCtrl",["$rootScope","$location","$state","Auth","ADDRESS",function(a,b,c,d,e){var f=c.current.name,g={},h=-1!=f.search("home-address");g=h?{address:"homeAddress"}:{address:"workAddress"},a.countries=e.COUNTRIES,a.states=e.STATES,a.user=d.user;var i=!angular.isObject(a.user[g.address]);i?(a.user[g.address]={type:h?1:2},g.id=0,g.method="post"):(g.id=a.user[g.address].id,g.method="put"),-1!=f.search("profile")?(a.btn="Save",a.isSignUp=0,i?(a.user[g.address].state=a.states[0],a.user[g.address].country=a.countries[0]):(a.user[g.address].state=a.states[a.user[g.address].stateId],a.user[g.address].country=a.countries[a.user[g.address].countryId])):(a.btn="Continue",a.isSignUp=1,a.user[g.address].state=a.states[0],a.user[g.address].country=a.countries[0]),a.submitForm=function(){var b={stateId:a.states.indexOf(a.user[g.address].state),countryId:a.countries.indexOf(a.user[g.address].country),country:a.user[g.address].country.name,stateId:a.states.indexOf(a.user[g.address].state),state:a.user[g.address].state.name,line1:a.user[g.address].line1,line2:a.user[g.address].line2,city:a.user[g.address].city,zip:a.user[g.address].zip,type:a.user[g.address].type,otherState:null};d.address(b,a.user.id,g.id,g.method,function(b){var e;e=a.isSignUp?h?"user.signup.contact-info":"user.signup.home-address":"user.home",c.go(e),a.user[g.address]=b,d.update(a.user,function(a){console.log(a)},function(a){console.log(a)},a.isSignUp)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("ContactInfoCtrl",["$rootScope","$state","Auth",function(a,b,c){a.is_add_account=b.current.data.is_add_account,a.user=a.is_add_account?c.getTempUser():c.user,console.log(c),a.disabledMail=c.isRootAccount(a.user),b.is("user.profile.contact-info")||b.is("user.add-account.contact-info")?(a.btn="Save",a.isSignUp=0):(a.btn="Continue",a.isSignUp=1),1==a.isSignUp&&(a.user.primaryEmail=a.user.userName),console.log(a.user),a.submitForm=function(){a.is_add_account?c.createAccount(a.user,1,function(){a.hide_switch=0,b.go("user.home")},function(a){console.log(a)}):c.update(a.user,function(){b.go("user.home")},function(a){console.log(a)},0)},a.submitLink=a.submitForm}]).controller("MeasurementsCtrl",["$scope","Auth",function(a,b){a.user=b.user,a.submitForm=function(){b.update(a.user,function(){$state.go("user.home")})},a.submitLink=a.submitForm}]).controller("SignupCtrl",["$scope","Auth",function(a,b){a.user={},a.submitForm=function(){a.waiting=1,a.showError=0,a.user.email_verify=a.user.email,b.register(a.user,function(){a.waiting=0,a.formSuccess=1},function(){a.waiting=0,a.showError=1})}}]).controller("SignupConfirmationCtrl",["$scope","$timeout","$stateParams","$state","UserService",function(a,b,c,d,e){a.confirmation_code=c.token,a.submitForm=function(){a.waiting=1,e.confirmEmail(a.confirmation_code,function(){a.waiting=0,b(function(){d.go("anon.login")},2500)},function(){a.waiting=0})}}]).controller("TermsCtrl",["$scope","$state","Auth","UserService",function(a,b,c,d){a.user=c.user,a.submitForm=function(){d.acceptTerms(a.user,function(){b.go("user.signup.basic-information")},function(a){console.log("error: "+a)})},a.sendEmail=function(){d.serviceAgreementEmail(a.user,function(){console.log("Service Agreement email sent")},function(a){console.log(a)})}}]).controller("LoginCtrl",["$scope","$state","$location","Auth",function(a,b,c,d){a.is_login_page=1,a.user={},a.submitForm=function(){a.waiting=1,d.login(a.user,function(e){a.waiting=0,e.tncCompleted?c.path(d.getLoggedinPath()):b.go("user.signup.terms")},function(){a.waiting=0})}}]).controller("ItemsCtrl",["$scope","$state","$filter","ApiService",function(a,b,c,d){function e(b){a.chartConfig={options:{credits:!1,chart:{type:"line",spacingRight:0,spacingLeft:0,style:{fontFamily:"'roboto', sans-serif"},spacingBottom:45},legend:{enabled:!1},plotOptions:{area:{fillColor:"#77D6E7",fillOpacity:1,lineColor:"#25A3CA",lineWidth:4,marker:{fillColor:"#303C4B",height:12,lineWidth:3,symbol:"circle",width:12},threshold:null}},title:{text:null,x:0},tooltip:{backgroundColor:"#303C4B",borderRadius:10,borderWidth:0,formatter:function(){return this.y+"lbs"},shadow:!1,style:{color:"#fff",fontSize:"22px",padding:"10px 15px",fontFamily:"'roboto', sans-serif"}},xAxis:{title:{text:'<span class="chart-xAxis-title">October 2014</span>',offset:0,useHTML:!0},labels:{formatter:function(){return'<span class="chart-day">'+this.value+"</span>"},y:18,useHTML:!0},maxPadding:0,minPadding:0,min:1,endOnTick:!0,startOnTick:!0,tickColor:"#4D5966",tickWidth:1,offset:31},yAxis:{gridLineWidth:0,labels:{enabled:!1},title:{text:null}}},series:[{type:"area"}],loading:!0},a.updateChart("day",b)}a.itemData=b.current.data,a.waiting=1,a.FileTypes=[{color:"#FCC475",value:1,name:"CTScan"},{color:"#65CBA5",value:2,name:"LabReport"},{color:"#FB6FBD",value:3,name:"Imaging"},{color:"#3C9EDC",value:4,name:"MedicalReport"},{color:"#FF846E",value:5,name:"MRI"},{color:"#908DD7",value:6,name:"XRay"},{color:"#35A77C",value:100,name:"Other"},{color:"#D84968",value:101,name:"ConsultReport"},{color:"#1878B6",value:102,name:"PandA"},{color:"#E8A648",value:103,name:"StatusReport"}];var f="undefined"==typeof a.itemData.apiShortcut?a.itemData.shortcut.replace(/-/g,""):a.itemData.apiShortcut;a.updateChart=function(b,d){chartData={categories:[],series:[],unit:"",period:""},a.chartConfig.loading=!0;var e;"day"===b&&(e=d),angular.forEach(e,function(b){var d=c("date")(b.date,"EEE d");d=d.split(" "),d='<span class="chart-day-name">'+d[0]+'</span><span class="chart-day-num">'+d[1]+"</span>",this.categories.push(d),this.series.push(Number(b[a.itemData.shortcutSingle]))},chartData),chartData.categories.unshift('<span class="chart-day-name"></span><span class="chart-day-num"></span>'),chartData.categories.push('<span class="chart-day-name"></span><span class="chart-day-num"></span>'),chartData.series.unshift(0),chartData.series.push(0),console.log(chartData),a.chartConfig.options.xAxis.categories=chartData.categories,a.chartConfig.options.xAxis.max=chartData.categories.length-2,a.chartConfig.series[0].data=chartData.series,a.chartConfig.loading=!1},d.list(f,function(b){function d(a){angular.forEach(a,function(a){a.name=c("date")(a.date,"MMMM dd, yyyy")})}switch(f){case"weights":d(b)}var g=a.itemData.shortcut;if(console.log("data: ",b),"conditions"==g||"family-histories"==g){var h={};angular.forEach(b,function(a,b){console.log(a,b),"conditions"==g?1==a.relationship&&(h[b]=a):1!=a.relationship&&(h[b]=a)}),b=0===Object.getOwnPropertyNames(h).length?void 0:h}console.log("data: ",b),a.collection=b,a.waiting=0,a.itemData.hasChart&&"undefined"!==b&&e(b)},function(a){console.log(a)})}]).controller("ItemCreateCtrl",["$scope","$state","$location","ApiService",function(a,b,c,d){a.itemData=b.current.data,"undefined"==typeof a.itemData.placeholder&&(a.itemData.placeholder="Enter "+a.itemData.item),a.collection={};var e="undefined"==typeof a.itemData.apiShortcut?a.itemData.shortcut.replace(/-/g,""):a.itemData.apiShortcut;a.submitForm=function(){d.create(e,a.collection,function(b){c.path(a.itemData.type+"/"+a.itemData.shortcutSingle+"/"+b.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("ItemEditCtrl",["$scope","$stateParams","$location","ApiService","$state",function(a,b,c,d,e){a.itemData=e.current.data,a.itemData.id=b.id;var f="undefined"==typeof a.itemData.apiShortcut?a.itemData.shortcut.replace(/-/g,""):a.itemData.apiShortcut;d.get(f,b.id,function(b){a.collection=b},function(a){console.log(a)}),a.submitForm=function(){d.save(f,a.collection.id,a.collection,function(){c.path(a.itemData.type+"/"+a.itemData.shortcutSingle+"/"+b.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("ItemViewCtrl",["$scope","$state","$location","$stateParams","ApiService",function(a,b,c,d,e){a.itemData=b.current.data;var f="undefined"==typeof a.itemData.apiShortcut?a.itemData.shortcut.replace(/-/g,""):a.itemData.apiShortcut;e.get(f,d.id,function(b){a.collection=b},function(a){console.log(a)}),a.deleteItem=function(){e.delete(f,d.id,function(){c.path(a.itemData.type+"/"+a.itemData.shortcut)},function(a){console.log(a)})}}]).controller("BodySystemsCtrl",["$scope","$state","ApiService",function(a,b,c){a.bodysystems={},c.get("bodysymptoms",1,function(b,c){angular.forEach(b,function(b){"undefined"==typeof a.bodysystems[b.systemName.toLowerCase()]&&(a.bodysystems[b.systemName.toLowerCase()]={},c||(a.bodysystems[b.systemName.toLowerCase()]["none_"+b.systemName.toLowerCase()]={isSelected:!0})),a.bodysystems[b.systemName.toLowerCase()][b.id]=b,(b.isSelected||c)&&(a.bodysystems[b.systemName.toLowerCase()]["none_"+b.systemName.toLowerCase()]={isSelected:!1})})},function(a){console.log(a)}),a.checkEmptySection=function(b){var c=a.bodysystems[b];for(index in c)if(c[index])return!1;return!0},a.unselectAll=function(b){a.bodysystems[b]["none_"+b].isSelected&&angular.forEach(a.bodysystems[b],function(a,c,d){c!="none_"+b&&(d[c].isSelected=!1)})},a.unselectNone=function(b,c){a.bodysystems[c][b].isSelected&&(a.bodysystems[c]["none_"+c].isSelected=!1)},a.submitForm=function(){var d=[];angular.forEach(a.bodysystems,function(a){angular.forEach(a,function(a,b){-1==b.search("none_")&&(d[d.length]=a)})}),console.log(d),c.save("bodysymptoms",1,d,function(){b.go("user.home")},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("AllergyCreateCtrl",["$scope","$state","$stateParams","$location","ApiService",function(a,b,c,d,e){a.itemData=b.current.data,a.type=[{name:"Type",is_disabled:1},{name:"Drug"},{name:"Food"},{name:"Environment"}],a.allergy={},a.allergy.type=a.type[0],a.submitForm=function(){a.allergy.type=a.type.indexOf(a.allergy.type),e.create("allergies",a.allergy,function(b){d.path(a.itemData.type+"/"+a.itemData.shortcutSingle+"/"+b.id)},function(a){console.log(a)})},a.$watch("allergy.type",function(b){a.allergyform.allergy_type.$setValidity("selgender",a.type.indexOf(b)>0)}),a.submitLink=a.submitForm}]).controller("AllergyEditCtrl",["$scope","$state","$stateParams","$location","ApiService",function(a,b,c,d,e){a.itemData=b.current.data,a.type=[{name:"Type",is_disabled:1},{name:"Drug"},{name:"Food"},{name:"Environment"}],e.get("allergies",c.id,function(b){a.allergy=b,"undefined"==typeof b.type?a.allergy.type=a.type[0]:(b.type=4==b.type?0:b.type,a.allergy.type=a.type[b.type],a.allergy.startDate=new Date(b.startDate))},function(a){console.log(a)}),a.submitForm=function(){var b={name:a.allergy.name,startDate:a.allergy.startDate};b.type=a.type.indexOf(a.allergy.type),e.save("allergies",a.allergy.id,b,function(){d.path("measurements/allergy/"+c.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("SleepEditCtrl",["$scope","$state","$stateParams","$filter","$location","ApiService",function(a,b,c,d,e,f){a.itemData=b.current.data,a.itemData.id=c.id,a.startedMax=d("date")(new Date,"yyyy-MM-dd"),f.get("sleeps",c.id,function(b){"undefined"==typeof b?(a.sleep={},a.sleep.hours=8,a.sleep.started=function(a){return a.setDate(a.getDate()-1),a}(new Date)):(a.sleep=b,a.sleep.started=new Date(a.sleep.started),a.faceClass=a.sleep.quality)},function(a){console.log(a)}),a.submitForm=function(){a.sleep.name=d("date")(a.sleep.started,"MMMM dd, yyyy"),a.sleep.id||(a.sleep.id=0),f.save("sleeps",a.sleep.id,a.sleep,function(a){e.path("measurements/sleep/"+a.id)},function(a){console.log(a)})},a.setDefault=function(b){a.faceClass=b},a.submitLink=a.submitForm}]).controller("BathroomEditCtrl",["$scope","$state","$stateParams","$filter","$location","ApiService",function(a,b,c,d,e,f){a.itemData=b.current.data,a.itemData.id=c.id,a.urine_color=["Clear","Light yellow","Dark yellow","Light red","Red","Other"],a.bowel_color=["Brown","Black","Grey","Other"],a.datetimeMax=d("date")(function(a){return a.setDate(a.getDate()+1),a}(new Date),"yyyy-MM-dd"),f.get("bathrooms",c.id,function(b){"undefined"==typeof b?(a.bathroom={},a.bathroom.urine_color=a.urine_color[1],a.bathroom.bowel_color=a.bowel_color[0],a.bathroom.consistency=a.bathroom.bowel_odor=50,a.bathroom.urine=a.bathroom.bowel="no",a.bathroom.datetime=new Date):(a.bathroom=b,a.bathroom.datetime=new Date(a.bathroom.datetime)),a.bathroom.urine_color_num=a.urine_color.indexOf(a.bathroom.urine_color),a.bathroom.bowel_color_num=a.bowel_color.indexOf(a.bathroom.bowel_color)},function(a){console.log(a)}),a.submitForm=function(){a.bathroom.name=d("date")(a.bathroom.datetime,"MMMM dd, yyyy"),a.bathroom.id||(a.bathroom.id=0),f.save("bathrooms",a.bathroom.id,a.bathroom,function(a){e.path("measurements/bathroom/"+a.id)},function(a){console.log(a)})},a.sliderChange=function(b){a.bathroom[b]=a[b][a.bathroom[b+"_num"]]},a.submitLink=a.submitForm}]).controller("ExercisesEditCtrl",["$scope","$state","$stateParams","$filter","$location","ApiService",function(a,b,c,d,e,f){a.itemData=b.current.data,a.itemData.id=c.id,a.units=[{name:"Units",is_disabled:1},{name:"Miles"},{name:"Kilometers"},{name:"Reps"}],a.times=[{name:"Time of day",is_disabled:1},{name:"Early morning"},{name:"Morning"},{name:"Lunchtime"},{name:"Afternoon"},{name:"Evening"},{name:"Night time"},{name:"Varies"}],f.get("exercises",c.id,function(b){if(a.exercise=b,"undefined"==typeof b.time)a.exercise.time=a.times[0],a.exercise.units=a.units[0];else{var c=d("filter")(a.times,b.time,!0),e=d("filter")(a.units,b.units,!0);a.exercise.time=c[0],a.exercise.units=e[0]}},function(a){console.log(a)}),a.submitForm=function(){f.save("exercises",a.exercise.id,a.exercise,function(){e.path("measurements/exercise/"+c.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("MedicationCreateCtrl",["$scope","$state","$stateParams","$filter","$location","ApiService","Notification",function(a,b,c,d,e,f,g){a.itemData=b.current.data,a.itemData.id=c.id,a.frequency=[{name:"Frequency",is_disabled:1},{name:"Not Specified"},{name:"One time daily"},{name:"Two times daily"},{name:"Three times daily"},{name:"Four times daily"},{name:"At bedtime"},{name:"Evening or afternoon"},{name:"Every 1 hour"},{name:"Every 2 hours"},{name:"Every 3 hours"},{name:"Every 4 hours"},{name:"Every 5 hours"},{name:"Every 6 hours"},{name:"Every 7 hours"},{name:"Every 8 hours"},{name:"Every 12 hours"},{name:"Every morning"},{name:"Every afternoon"},{name:"Every evening"},{name:"Every night"},{name:"Every night at bedtime"}],a.medication={},a.medication.name="",a.medication.frequency=a.frequency[0],a.medication.dosage="",a.submitForm=function(){if(a.medication.startDate&&a.medication.endDate){if(a.medication.endDate.getTime()<a.medication.startDate.getTime())return void g.show("Start date can't be greater than end date","danger",1)}else{if(a.medication.endDate)return void g.show("Plz select Start date","danger",1);if(a.medication.startDate)return void g.show("Plz select End date","danger",1)}var c={name:a.medication.name,dosage:a.medication.dosage,startDate:a.medication.startDate,endDate:a.medication.endDate};c.frequency=a.frequency.indexOf(a.medication.frequency)>0?a.frequency.indexOf(a.medication.frequency)-1:0,f.create("medications",c,function(){b.go("user.measurements.medications")},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("MedicationsEditCtrl",["$scope","$state","$stateParams","$filter","$location","ApiService","Notification",function(a,b,c,d,e,f,g){a.itemData=b.current.data,a.itemData.id=c.id,a.frequency=[{name:"Frequency",is_disabled:1},{name:"Not Specified"},{name:"One time daily"},{name:"Two times daily"},{name:"Three times daily"},{name:"Four times daily"},{name:"At bedtime"},{name:"Evening or afternoon"},{name:"Every 1 hour"},{name:"Every 2 hours"},{name:"Every 3 hours"},{name:"Every 4 hours"},{name:"Every 5 hours"},{name:"Every 6 hours"},{name:"Every 7 hours"},{name:"Every 8 hours"},{name:"Every 12 hours"},{name:"Every morning"},{name:"Every afternoon"},{name:"Every evening"},{name:"Every night"},{name:"Every night at bedtime"}],f.get("medications",c.id,function(b){a.medication=b,"undefined"==typeof b.frequency?a.medication.frequency=a.frequency[0]:(b.frequency=21==b.frequency?0:b.frequency,a.medication.frequency=a.frequency[b.frequency],a.medication.startDate=new Date(b.startDate),a.medication.endDate=new Date(b.endDate)),a.minDate=a.medication.startDate},function(a){console.log(a)}),a.submitForm=function(){if(a.medication.endDate.getTime()<a.medication.startDate.getTime())return void g.show("Start date can't be greater than end date","danger",1);var b={name:a.medication.name,dosage:a.medication.dosage,startDate:a.medication.startDate,endDate:a.medication.endDate};b.frequency=a.frequency.indexOf(a.medication.frequency)-1,f.save("medications",a.medication.id,b,function(){e.path("measurements/medication/"+c.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("FoodsdrinksEditCtrl",["$scope","$state","$stateParams","$filter","$location","ApiService",function(a,b,c,d,e,f){a.itemData=b.current.data,a.itemData.id=c.id,a.meals=[{name:"Meal",is_disabled:1},{name:"Breakfast"},{name:"Dinner"},{name:"Lunch"},{name:"Snack"}],f.get("foodsdrinks",c.id,function(b){if(a.fooddrink=b,"undefined"==typeof b.meal)a.fooddrink.meal=a.meals[0];else{var c=d("filter")(a.meals,b.meal,!0);a.fooddrink.meal=c[0]}},function(a){console.log(a)}),a.submitForm=function(){f.save("foodsdrinks",a.fooddrink.id,a.fooddrink,function(){e.path("measurements/fooddrink/"+c.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("NaturalSupplementsEditCtrl",["$scope","$state","$stateParams","$filter","$location","ApiService",function(a,b,c,d,e,f){a.itemData=b.current.data,a.itemData.id=c.id,a.units=[{name:"Units",is_disabled:1},{name:"cfu/mo"},{name:"iu"},{name:"mcg"},{name:"meq"},{name:"meq/ml"},{name:"mg"},{name:"mg/ml"},{name:"ml"},{name:"%"},{name:"unt"},{name:"unt/ml"}],a.dosages=[{name:"How Taken",is_disabled:1},{name:"by injection"},{name:"my mouth"},{name:"in the ear"},{name:"in the eye"},{name:"in the nose"},{name:"inhaled"},{name:"rectal"},{name:"through a feeding tube"},{name:"through an intravenous line (IV)"},{name:"through the skin"},{name:"under the tongue"},{name:"vaginal"}],f.get("naturalsupplements",c.id,function(b){if(a.naturalsupplements=b,"undefined"==typeof b.units)a.naturalsupplements.units=a.units[0],a.naturalsupplements.dosages=a.dosages[0];else{var c=d("filter")(a.units,b.units,!0),e=d("filter")(a.dosages,b.dosages,!0);a.naturalsupplements.units=c[0],a.naturalsupplements.dosages=e[0]}},function(a){console.log(a)}),a.submitForm=function(){f.save("naturalsupplements",a.naturalsupplements.id,a.naturalsupplements,function(){e.path("measurements/natural-supplement/"+c.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("immunizationsEditCtrl",["$scope","$state","$stateParams","$location","ApiService",function(a,b,c,d,e){a.itemData=b.current.data,a.itemData.id=c.id,e.get("immunizations",c.id,function(b){a.immunization=b,"undefined"==typeof b.number_in_series_n&&(a.immunization.number_in_series_n="0",a.immunization.number_in_series_s="1")},function(a){console.log(a)}),a.submitForm=function(){e.save("immunizations",a.immunization.id,a.immunization,function(){d.path("measurements/immunization/"+c.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("WeightsEditCtrl",["$scope","$timeout","$state","$stateParams","$location","ApiService",function(a,b,c,d,e,f){a.itemData=c.current.data,a.itemData.id=d.id,a.units=["lbs","kg"],f.get("weights",d.id,function(c){if("undefined"==typeof c){a.weight={};var d=new Date;a.weight.date=d,a.weight.time=d.getHours()+":"+d.getMinutes(),a.weight.unit=a.units[0]}else a.weight=c,b(function(){var a=document.getElementById("knob-input");if("createEvent"in document){var b=document.createEvent("HTMLEvents");b.initEvent("change",!1,!0),a.dispatchEvent(b)}else a.fireEvent("onchange")},250)},function(a){console.log(a)}),a.submitForm=function(){a.weight.weight=document.getElementById("knob-input").value,f.save("weights",a.weight.id,a.weight,function(a){e.path("measurements/weight/"+a.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("HeightsCtrl",["$scope","ApiService",function(a,b){b.list("heights",function(b){a.heights=b})}]).controller("HeightsCreateCtrl",["$scope","$location","ApiService",function(a,b,c){a.height={},a.submitForm=function(){a.height.date=new Date,a.height.time=a.height.date.getHours()+":"+a.height.date.getMinutes(),c.save("heights",a.height.id,a.height,function(){b.path("measurements/heights")},function(a){console.log(a)})},a.submitLink=a.submitForm,a.changeKnob=function(b,c){a.height.height=document.getElementById(b).value,a.height.unit=c}}]).controller("HeightsEditCtrl",["$timeout","$scope","$route","$stateParams","$location","ApiService",function(a,b,c,d,e,f){b.units=["ft","cm","in"],b.data={},f.get("heights",d.id,function(c){b.height=c,"in"==c.unit?b.data.in_type=!0:"ft"==c.unit&&(b.data.ft_type=!0),a(function(){var a=document.getElementById("knob-input-ft"),b=document.getElementById("knob-input-in");if("createEvent"in document){var c=document.createEvent("HTMLEvents");c.initEvent("change",!1,!0),a.dispatchEvent(c),b.dispatchEvent(c)}else a.fireEvent("onchange"),b.fireEvent("onchange")})},function(a){console.log(a)}),b.submitForm=function(){"ft"==b.height.unit?b.height.height=document.getElementById("knob-input-ft").value:"in"==b.height.unit&&(b.height.height=document.getElementById("knob-input-in").value),f.save("heights",b.height.id,b.height,function(){e.path("measurements/heights/"+d.id)},function(a){console.log(a)})},b.submitLink=b.submitForm}]).controller("HeightsViewCtrl",["$scope","$stateParams","ApiService",function(a,b,c){c.get("heights",b.id,function(b){a.height=b},function(a){console.log(a)})}]).controller("LabresultsEditCtrl",["$scope","$state","$stateParams","$filter","$location","ApiService",function(a,b,c,d,e,f){a.itemData=b.current.data,a.itemData.id=c.id,a.status=[{name:"Status",is_disabled:1},{name:"complete"},{name:"patient refused test"},{name:"pending"},{name:"quantity not sufficient"}],f.get("labresults",c.id,function(b){if(a.labresult=b,"undefined"==typeof b.status)a.labresult.status=a.status[0];else{var c=d("filter")(a.status,b.status,!0);a.labresult.status=c[0]}},function(a){console.log(a)}),a.submitForm=function(){f.save("labresults",a.labresult.id,a.labresult,function(){e.path("histories/lab-result/"+c.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("ProceduresEditCtrl",["$scope","$state","$stateParams","$filter","$location","ApiService",function(a,b,c,d,e,f){a.itemData=b.current.data,a.itemData.id=c.id,a.status=[{name:"Status",is_disabled:1},{name:"Current"},{name:"Intermittent"},{name:"Past"}],f.get("procedures",c.id,function(b){if(a.procedure=b,"undefined"==typeof b.status)a.procedure.status=a.status[0];else{var c=d("filter")(a.status,b.status,!0);a.procedure.status=c[0]}},function(a){console.log(a)}),a.submitForm=function(){f.save("procedures",a.procedure.id,a.procedure,function(){e.path("histories/procedure/"+c.id)},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("FamilyCreateCtrl",["$rootScope","$scope","$state","$stateParams","$filter","$location","ApiService","Auth","RELATIONSHIPS",function(a,b,c,d,e,f,g,h){b.itemData=c.current.data,b.itemData.id=d.id,b.status=[{name:"Status",is_disabled:1},{name:"None"},{name:"Inactive"},{name:"Active"},{name:"Resolved"},{name:"Remission"}],b.onset=[{name:"Onset",is_disabled:1},{name:"1-2 weeks ago"},{name:"1-3 months ago"},{name:"4-6 months ago"},{name:"6-12 months ago"},{name:"1 year ago"},{name:"2 years ago"},{name:"3-5 years ago"},{name:"5-7 years ago"},{name:"7-10 years ago"},{name:"More than 10 years ago"}],b.relationships=[{name:"Relationship to you",is_disabled:1},{name:"Father"},{name:"Mother"},{name:"Brother"},{name:"Sister"},{name:"GrandFather"},{name:"GrandMother"}],b.conditions={},b.conditions.relationship=b.relationships[0],b.submitForm=function(){var a={name:b.conditions.name,relationship:"undefined"==typeof b.conditions.relationship?h.user.relationship:b.relationships.indexOf(b.conditions.relationship)};a.relationship+=a.relationship<5?5:10,g.create("mc",a,function(){f.path("histories/family-histories")},function(a){console.log(a)},"Family history")},b.$watch("conditions.relationship",function(){b.familyform.reltype.$setValidity("selgender",b.relationships.indexOf(b.conditions.relationship)>0)}),b.submitLink=b.submitForm}]).controller("ConditionCreateCtrl",["$rootScope","$scope","$state","$stateParams","$filter","$location","ApiService","Auth","RELATIONSHIPS",function(a,b,c,d,e,f,g){b.itemData=c.current.data,b.itemData.id=d.id,b.status=[{name:"Status",is_disabled:1},{name:"None"},{name:"Inactive"},{name:"Active"},{name:"Resolved"},{name:"Remission"}],b.onset=[{name:"Onset",is_disabled:1},{name:"1-2 weeks ago"},{name:"1-3 months ago"},{name:"4-6 months ago"},{name:"6-12 months ago"},{name:"1 year ago"},{name:"2 years ago"},{name:"3-5 years ago"},{name:"5-7 years ago"},{name:"7-10 years ago"},{name:"More than 10 years ago"}],b.conditions={},b.conditions.status=b.status[0],b.conditions.onset=b.onset[0],b.submitForm=function(){var a={name:b.conditions.name};a.relationship=1,a.onset=b.onset.indexOf(b.conditions.onset),a.status=b.status.indexOf(b.conditions.status),a.status>0&&(a.status-=1),g.create("mc",a,function(){f.path("histories/conditions")},function(a){console.log(a)},"Condition history")},b.submitLink=b.submitForm}]).controller("ConditionsEditCtrl",["$rootScope","$scope","$state","$stateParams","$filter","$location","ApiService","Auth","RELATIONSHIPS",function(a,b,c,d,e,f,g,h,i){b.itemData=c.current.data,b.itemData.id=d.id,b.status=[{name:"Status",is_disabled:1},{name:"None"},{name:"Inactive"},{name:"Active"},{name:"Resolved"},{name:"Remission"}],b.onset=[{name:"Onset",is_disabled:1},{name:"1-2 weeks ago"},{name:"1-3 months ago"},{name:"4-6 months ago"},{name:"6-12 months ago"},{name:"1 year ago"},{name:"2 years ago"},{name:"3-5 years ago"},{name:"5-7 years ago"},{name:"7-10 years ago"},{name:"More than 10 years ago"}],b.relationships=i.slice(),b.relationships.splice(1,1);var j,k=b.itemData.apiShortcut;"family-history"==b.itemData.shortcutSingle&&(b.relationships=[{name:"Relationship to you",is_disabled:1},{name:"Father"},{name:"Mother"},{name:"Brother"},{name:"Sister"},{name:"GrandFather"},{name:"GrandMother"}]),g.get(k,d.id,function(c){b.conditions=c;var d=a.fromState.name,e="user.histories.family-create"===d;j=-1==d.search("surgical"),j&&(e?(b.conditions.status=b.status[0],b.conditions.onset=b.onset[0],b.conditions.relationship=b.relationships[0]):(b.conditions.status=b.status[c.status+1],c.onset=0==c.onset?0:c.onset,b.conditions.onset=b.onset[c.onset],"conditions"!=b.itemData.shortcut&&(b.conditions.relationship=c.relationship>14?b.relationships[c.relationship-10]:b.relationships[c.relationship-5])))
},function(a){console.log(a)}),b.submitForm=function(){if(j){var a={name:b.conditions.name,relationship:"undefined"==typeof b.conditions.relationship?h.user.relationship:b.relationships.indexOf(b.conditions.relationship)};a.relationship+=a.relationship<5?5:10,a.onset=b.onset.indexOf(b.conditions.onset),a.status=b.status.indexOf(b.conditions.status),a.status>0&&(a.status-=1)}else var a={name:b.conditions.name,type:2};g.save(k,b.conditions.id,a,function(){f.path("histories/"+b.itemData.shortcutSingle+"/"+d.id)},function(a){console.log(a)})},b.submitLink=b.submitForm}]).controller("SocialHistoryCtrl",["$scope","$state","ApiService",function(a,b,c){a.socialstatus={},a.MaritalStatus=[{name:"Marital Status",is_disabled:1},{name:"Single"},{name:"Married"},{name:"Separated"},{name:"Widowed"},{name:"Divorced"}],c.get("socialstatus",1,function(b,c){if(c)a.socialstatus[10]=a.MaritalStatus[0];else for(var d=b.length-1;d>=0;d--){var e=b[d].id,f=b[d].answer;f=10==e?a.MaritalStatus[f]:f,a.socialstatus[e]=f}},function(a){console.log(a)}),a.submitForm=function(){var d=[];angular.forEach(a.socialstatus,function(b,c){var e=angular.isObject(b)?a.MaritalStatus.indexOf(a.socialstatus[10]):b;d[d.length]={id:c,answer:e}}),console.log(d),c.save("socialstatus",1,d,function(){b.go("user.home")},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("SummariesViewCrtl",["$scope","$route","ApiService",function(a,b,c){a.waiting=1,c.getSummary(function(b){console.log("summary",b),a.waiting=0,a.person="1"==b.patient.gender?"He":"She",a.summary=b;var c=new Date,d=new Date(b.patient.dob),e=d.getMonth(),f=d.getDate(),g=c.getFullYear()-d.getFullYear();(c.getMonth()<e||c.getMonth()==e&&c.getDate()<f)&&g--,a.age=g},function(a){console.log(a)})}]).controller("ShareCrtl",["$scope","$state","$filter","ApiService","UserService",function(a,b,c,d,e){a.waiting=1,a.today=c("date")(new Date,"yyyy-MM-dd"),a.shareData={},a.user={},e.getAccounts(function(b){a.accounts_original=b,b.length>1?(a.accounts=[{name:"Choose an account to share",is_disabled:1}],angular.forEach(b,function(b,c){a.accounts[c+1]={name:b.firstName+" "+b.lastName}}),a.user.account=a.accounts[0]):a.accounts=0,a.waiting=0,a.$watch("user.account",function(b){console.log("asdfasdfasdf"),console.log(a.share_form.share_account),a.share_form.share_account&&a.share_form.share_account.$setValidity("selgender",a.accounts.indexOf(b)>0)})}),a.submitForm=function(){var c=0;a.user.account&&(c=a.accounts_original[a.accounts.indexOf(a.user.account)-1].id),d.share(a.shareData,c,function(){b.go("user.home")},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("SharedCrtl",["$scope","$state","$filter","ApiService",function(a,b,c,d){console.log(b.current),a.today=c("date")(new Date,"yyyy-MM-dd"),a.waiting=1,a.type=b.current.data.type,a.title="byMe"==a.type?"Shared By Me":"Shared With Me",a.predicate="sharedDate",a.hstate=b.current,d.shared(a.type,0,function(b){angular.forEach(b,function(c,d){b[d].key=d,b[d].expiryDate=new Date(c.expiryDate),b[d].updateItems=function(b){a.updateItems(b)},b[d].editItem=function(b,c){a.editItem(b,c)}}),a.collection=b.length?b:0,a.shared=b.length?b:0,a.waiting=0},function(a){console.log(a)})}]).controller("SharedDetailCrtl",["$scope","$state","$filter","ApiService","$stateParams",function(a,b,c,d,e){a.today=c("date")(new Date,"yyyy-MM-dd"),a.waiting=1,a.type=b.current.data.type,a.title="byMe"==a.type?"Shared By Me":"Shared With Me",a.predicate="sharedDate",a.backurl=b.current.data.backurl,d.shared(a.type,0,function(b){angular.forEach(b,function(c,d){b[d].key=d,b[d].expiryDate=c.expiryDate&&c.expiryDate>new Date?new Date(c.expiryDate):new Date,b[d].updateItems=function(b){a.updateItems(b)},b[d].editItem=function(b,c){a.editItem(b,c)}}),a.collection=b[e.id];var c=[b[e.id]];a.shared=c,a.waiting=0},function(a){console.log(a)}),a.sortTable=function(b){a.predicate=b,a.reverse=!a.reverse},a.editItem=function(b,c){a.shared[b].editMode=c},a.updateItems=function(c){a.editItem(c,0);var e=a.shared[c],f={id:e.senderNotes[0].id,note:e.note,expiryDate:e.expiryDate.toString()};d.shared(a.type,1,function(){b.go("user.home")},function(a){console.log(a)},f)}}]).controller("DocumentsViewCrtl",["$scope","$route","$stateParams","ApiService",function(a,b,c,d){d.list("docsvault",function(b){var d=b.filter(function(a){return a.id==c.id});if(1!=d[0].type&&5!=d[0].type&&6!=d[0].type){a.waiting=1;var e=window.open(d[0].linkId,"_blank","location=no,enableViewportScale=yes,toolbarposition=top");e.addEventListener("exit",function(){window.history.back()}),a.documentData=d[0]}else{a.documentData=d[0];var f=angular.element("<iframe>").attr("src",a.documentData.linkId).attr("style","width:"+window.innerWidth+"px; height:"+(window.innerHeight-100)+"px;");angular.element(document.getElementsByClassName("scrollable-content")).append(f).attr("height",window.innerHeight-38+"px;")}},function(a){console.log(a)})}]).controller("ChangePasswordCtrl",["$scope","Auth","UserService",function(a,b,c){a.submitForm=function(){console.log(a.data),c.changePassword(a.data,function(){$state.go("user.home")},function(a){console.log(a)})},a.submitLink=a.submitForm}]).controller("PhysicianCtrl",["$scope","$route","$stateParams","ApiService","Auth",function(a,b,c,d,e){a.data={},a.data.practice=e.user.practice,a.checkCode=function(){d.get("practices",a.data.code,function(b){a.data.practice=b},function(a){console.log(a)})},a.submitLink=function(){e.user.practice=a.data.practice,e.update(e.user,function(a){console.log(a)},function(a){console.log(a)})}}]).controller("ForgotPasswordCtrl",["$scope","UserService",function(a,b){a.submitForm=function(){a.waiting=1,b.forgotPassword(a.email,function(b){a.waiting=0,a.msg=b,a.formSuccess=1},function(){a.waiting=0})}}]).controller("ForgotPasswordConfirmationCtrl",["$scope","$stateParams","$state","UserService",function(a,b,c,d){a.data={token:b.token},a.submitForm=function(){a.waiting=1,d.forgotChangePassword(a.data,function(){a.waiting=0,c.go("anon.login")},function(b){a.waiting=0,console.log(b)})}}]);var appDirectives=angular.module("appDirectives",[]);appDirectives.directive("knob",function(){function a(a,b){Ui.knob=function(){},Ui.knob.prototype=Object.create(Ui.prototype),Ui.knob.prototype.createElement=function(){Ui.prototype.createElement.apply(this,arguments),this.addComponent(new Ui.Arc({arcWidth:18})),this.addComponent(new Ui.Text),this.addComponent(new Ui.Pointer(this.merge(this.options,{type:"Circle",pointerWidth:28,offset:-45}))),this.merge(this.options,{arcWidth:18});var a=new Ui.El.Arc(this.options);a.setAngle(this.options.anglerange),this.el.node.appendChild(a.node),this.el.node.setAttribute("class","knob")},new Knob(b[0],new Ui.knob)}return{restrict:"A",link:a}}).directive("bottombar",["$rootScope",function(a){function b(){a.hasBottomBar=!0}return{restrict:"A",link:b}}]).directive("passwordVerify",function(){return{require:"ngModel",scope:{passwordVerify:"="},link:function(a,b,c,d){a.$watch(function(){var b;return(a.passwordVerify||d.$viewValue)&&(b=a.passwordVerify+"_"+d.$viewValue),b},function(b){b&&d.$parsers.unshift(function(b){var c=a.passwordVerify;return c!==b?void d.$setValidity("passwordVerify",!1):(d.$setValidity("passwordVerify",!0),b)})})}}}).directive("optionsDisabled",["$parse",function(a){var b=function(a,b,c,d,e){for(var f=c.find("option"),g=0,h=0;g<f.length;g++){var i=angular.element(f[g]);if(""!=i.val()){var j={};j[b]=d[h],i.attr("disabled",e(a,j)),h++}}};return{priority:0,require:"ngModel",link:function(c,d,e){var f=e.optionsDisabled.match(/^\s*(.+)\s+for\s+(.+)\s+in\s+(.+)?\s*/),g=f[3],h=a(f[1]);c.$watch(g,function(a){a&&b(c,f[2],d,a,h)},!0),c.$watch(e.ngModel,function(e){var i=a(g)(c);e&&b(c,f[2],d,i,h)})}}}]).directive("domOnCreate",["$parse","$timeout",function(a,b){return{link:function(c,d,e){b(function(){e.domOnCreate&&a(e.domOnCreate)(c)})}}}]).directive("domOnDestroy",["$parse",function(a){return{link:function(b,c,d){var e;d.domOnDestroy&&(e=a(d.domOnDestroy),c.on("$destroy",function(){console.log("removed"),e(b)}))}}}]).directive("cards",["$window","$timeout",function(a,b){function c(c,d){function e(){var a=d.prop("offsetHeight"),b=(a-278)/2;d.children().css({"padding-bottom":b+"px","padding-top":b+"px"})}angular.element(a).bind("resize",function(){e()}),b(function(){e(),d.css("opacity",1)},500)}return{restrict:"A",link:c}}]).directive("navbarajaxloader",["$http",function(a){function b(b,c){var d=angular.element(c);b.isLoading=function(){var b=a.pendingRequests;return b=b.length>0?"GET"==b[0].method?0:1:0},b.$watch(b.isLoading,function(a){a&&!b.loading?d.addClass("loading"):d.removeClass("loading")})}return{restrict:"A",link:b}}]);var appServices=angular.module("appServices",["LocalStorageModule","ui.router"]);appServices.factory("ApiService",["$http","$interval","API","Auth","localStorageService","Notification",function(a,b,c,d,e,f){return{list:function(g,h,i){function j(b,g,j,k){var m=e.get("authorizationData"),n={Authorization:"Bearer "+m.token};a.get(c.URL_PATIENTS+"/"+d.user.id+"/"+b,{headers:n}).success(function(a){return console.log("List items API success"),g?(l=0===j?1:0,void(a.length?(k[b]=a,console.log(a),"allergies"===b||"medications"===b||"bodysymptoms"===b?k.measurements=1:("mc"===b||"mh"===b)&&(k.histories=1)):k[b]={})):h(a.length?a:void 0)}).error(function(a,b){return a=a||"Request failed, please try again later.",console.log(a,b),f.show(a.message+" Please try again later.","danger",1),i(a)})}if("summaries"===g){for(var k=["mc","mh","allergies","medications","bodysymptoms"],l=0,m=0,n={},m=k.length-1;m>=0;m--)j(k[m],1,m,n);if(l)return h(n.length?n:{});var o=b(function(){return b.cancel(o),h(n)},1e3)}else j(g,0)},create:function(b,g,h,i,j){var k=e.get("authorizationData"),l={Authorization:"Bearer "+k.token};"mc"===b||("mh"===b?g.type=2:"allergies"===b?(j="Allergy",g.startDate=g.startDate?new Date(g.startDate.getTime()+432e5):new Date,console.log(g)):"medications"===b&&(console.log(g),j="Medication")),a.post(c.URL_PATIENTS+"/"+d.user.id+"/"+b,g,{headers:l}).success(function(a){return console.log(b+" created successfully"),""==j&&void 0==j&&"undefined"==j&&j?f.show(b+" created successfully","success",1):f.show(j+" created successfully","success",1),h(a)}).error(function(a,b){return a=a||"Request failed, please try again later.",console.log(a,b),f.show(a,"danger",1),i(a)})},save:function(b,g,h,i,j){if("home"==b){var k=e.get(b);return k||(k={}),k[g]=h,e.set(b,k),i(h)}var l=e.get("authorizationData"),m={Authorization:"Bearer "+l.token},n="put";"bodysymptoms"===b||"socialstatus"===b?(g="",n="post",e.set(b,0)):g="/"+g,a[n](c.URL_PATIENTS+"/"+d.user.id+"/"+b+g,h,{headers:m}).success(function(a){return console.log(b+" saved successfully"),i(a)}).error(function(a,b){return a=a||"Request failed, please try again later.",console.log(a,b),f.show(a.message,"danger",1),j(a)})},get:function(b,g,h,i){if("mc"!==b&&"mh"!==b&&"allergies"!==b&&"medications"!==b&&"bodysymptoms"!==b&&"socialstatus"!==b){var j=e.get(b);return j=j?j[g]:void 0,h(j)}var k=e.get("authorizationData"),l={Authorization:"Bearer "+k.token},m="bodysymptoms"===b||"socialstatus"===b;if(m){g="";var n=e.get(b);n=null==n?1:0}else g="/"+g;a.get(c.URL_PATIENTS+"/"+d.user.id+"/"+b+g,{headers:l}).success(function(a){return console.log("Get item API success"),m?h(a,n):h(a)}).error(function(a,b){return a=a||"Request failed, please try again later.",console.error(a,b),f.show(a,"danger",1),i(a)})},getSummary:function(b,g){var h=e.get("authorizationData"),i={Authorization:"Bearer "+h.token};a.get(c.URL_PATIENTS+"/"+d.user.id+"/healthsummary",{headers:i}).success(function(a){return console.log("Get summary API success"),b(a)}).error(function(a,b){return a=a||"Request failed, please try again later.",console.error(a,b),"Authorization has been denied for this request."==a.message?void d.needLogin():(f.show(a,"danger",1),g(a))})},"delete":function(b,g,h,i){var j=e.get("authorizationData"),k={Authorization:"Bearer "+j.token};a.delete(c.URL_PATIENTS+"/"+d.user.id+"/"+b+"/"+g,{headers:k}).success(function(a){return console.log(b+" deleted successfully"),f.show("Item deleted","success",1),h(a)}).error(function(a,b){return a=a||"Request failed, please try again later.",console.log(a,b),f.show(a,"danger",1),i(a)})},share:function(b,g,h,i){var j=e.get("authorizationData"),k={Authorization:"Bearer "+j.token};g||(g=d.user.id),b.expiryDate=new Date(b.expiryDate.getTime()+864e5-1),a.post(c.URL_PATIENTS+"/"+g+"/sharephr",b,{headers:k}).success(function(a){return f.show("Health Summary shared successfully","success",1),h(a)}).error(function(a,b){return console.log(a,b),f.show(a,"danger",1),i(a)})},shared:function(b,g,h,i,j){var k=e.get("authorizationData"),l={Authorization:"Bearer "+k.token};g?(console.log(j),a.put(c.URL_PATIENTS+"/"+d.user.id+"/sharephr",j,{headers:l}).success(function(a){return console.table(a),f.show("Shared information updated successfully","success",1),h(a)}).error(function(a,b){return a=a||"Request failed, please try again later.",console.log(a,b),f.show(a.message,"danger",1),i(a)})):(b="byMe"==b?"phrsharedby":"phrsharedwith",a.get(c.URL_PATIENTS+"/"+d.user.id+"/"+b,{headers:l}).success(function(a){return console.table(a),h(a)}).error(function(a,b){return a=a||"Request failed, please try again later.",console.log(a,b),f.show(a.message,"danger",1),i(a)}))}}}]).factory("Notification",["$rootScope","$timeout",function(a,b){return{show:function(b,c,d){a.msg=b,a.ntf_type="alert-"+c,a.showNotification=1,d&&this.hide(2500)},hide:function(c){b(function(){a.showNotification=0},c)}}}]).factory("Overlay",["$rootScope",function(a){return{show:function(b,c,d,e){b.submitLabel="undefined"!=typeof b.submitLabel?b.submitLabel:"Submit",b.cancelLabel="undefined"!=typeof b.cancelLabel?b.cancelLabel:"Cancel",a.overlay=b,e&&(a.user={}),a.toggle("overlay","on"),a.overlay.sumitOverlay=c,a.overlay.cancelOverlay=d},hide:function(){a.toggle("overlay","off")}}}]).factory("UserService",["$rootScope","$http","$timeout","$location","$state","$filter","localStorageService","API","Notification","Overlay",function(a,b,c,d,e,f,g,h,i,j){return{login:function(a,d,e){var f="grant_type=password&username="+encodeURIComponent(a.email)+"&password="+a.password,j=this;b.post(h.URL+"/token",f,{headers:h.HEADERS}).success(function(b){return console.log("Login success"),i.show("Login success","success",1),c(function(){j.loginExpiration()},1e3*b.expires_in),g.set("authorizationData",{token:b.access_token,userName:a.email,expires_in:b.expires_in,login_date:new Date}),j.getProfile(d,e,{userName:a.email,role:{bitMask:2,title:"user"}},0,1)}).error(function(a,b){return a=a||{error_description:"Request failed, please try again later."},console.log(a,b),i.show(a.error_description,"danger",1),e(a.error_description)})},loginExpiration:function(){function b(){a.waiting=1,i.login(a.user,function(b){g.set("user",b),a.waiting=0;var d=e.$current.name,f=e;e.go("user.home"),c(function(){f.go(d)},500),j.hide()},function(){a.waiting=0})}function f(){j.hide(),d.path("logout")}var h={title:"Session expired, please login again",url:"views/common/login-form.html"},i=this;j.show(h,b,f,1)},getProfile:function(a,c,d,e,f){var j=this,k=g.get("authorizationData"),l={Authorization:"Bearer "+k.token};b.get(h.URL_PATIENTS+"/profile",{headers:l}).success(function(b){return console.log("Profile fetched"),angular.extend(d,b),console.table(d),f?(k.root_id=b.id,k.current_id=b.id,g.set("authorizationData",k)):(k.current_id=b.id,g.set("authorizationData",k)),e?j.getFullProfile(b.id,a,c,d):a(d)}).error(function(a,b){return a=a||"Request failed",console.log(a,b),i.show(a.error_description,"danger",1),c(a.error_description)})},getFullProfile:function(a,c,d,e){var f=g.get("authorizationData"),i={Authorization:"Bearer "+f.token};b.get(h.URL_PATIENTS+"/"+a,{headers:i}).success(function(a){return console.log("getFullProfile: ",a),angular.extend(e,a),c(e)}).error(function(a,b){return a=a||"Request failed",console.log(a,b),d(b)})},signup:function(a,c,d){var e={Email:a.email,ConfirmEmail:a.email_verify,Password:a.password,ConfirmPassword:a.confirm_password,FirstName:a.firstName,LastName:a.lastName};b.post(h.URL_PATIENTS+"/register",e).success(function(a){return console.log("Register success",a),c()}).error(function(a,b){return a=a||"Request failed",i.show(a,"danger",1),console.log(a,b),d()})},confirmEmail:function(a,c,d){a={Token:a},b.put(h.URL_PATIENTS+"/confirm",a).success(function(a){return console.log("Confirmation success",a),i.show(a,"success",0),c()}).error(function(a,b){return a=a||"Confirmation failed",i.show(a.invalidToken,"danger",1),d(a,b)})},acceptTerms:function(a,c,d){var e=g.get("authorizationData"),f={Authorization:"Bearer "+e.token},i={tncCompleted:!0};b.post(h.URL_PATIENTS+"/tnc",i,{headers:f}).success(function(b){return console.log("Terms & conditions API",b),a.tncCompleted=!0,c()}).error(function(a){return a=a||"Terms & conditions API error",d(a.message)})},save:function(a,c,d,e){if(a.dob=f("date")(a.dob,"MM-dd-yyyy"),e="undefined"==typeof e?1:e)return g.set("user",a),c(a);var j=g.get("authorizationData"),k={Authorization:"Bearer "+j.token};b.put(h.URL_PATIENTS+"/"+a.id,a,{headers:k}).success(function(a){return console.log("Update user profile API",a),c()}).error(function(a){return a=a||"Update user profile API error",i.show(a,"danger",1),d(a.message)})},createAccount:function(a,c,d){var f=g.get("authorizationData"),j={Authorization:"Bearer "+f.token};b.post(h.URL_PATIENTS,a,{headers:j}).success(function(a){return console.log("Save account API",a),i.show("Account created successfully","success",1),e.go("user.home"),c(a)}).error(function(a){return a=a||"Account API error",d(a.message)})},getAccounts:function(a){var c=g.get("authorizationData"),d={Authorization:"Bearer "+c.token},e=c.root_id;b.get(h.URL_PATIENTS+"/"+e+"/relatedpatients",{headers:d}).success(function(b){return console.table("relatedpatients: ",b),a(b)}).error(function(a){a=a||"Request failed",console.log(a,status)})},address:function(a,c,d,e,f,j){var k=g.get("authorizationData"),l={Authorization:"Bearer "+k.token},m=d?"/"+d:"";b[e](h.URL_PATIENTS+"/"+c+"/address"+m,a,{headers:l}).success(function(a){return a=a,console.log("Address API",a),d&&i.show("Address updated successfully","success",1),f(a)}).error(function(a,b){return a=a||"Address "+e+" failed",console.log(a,b),d&&i.show(a,"danger",1),j(a,b)})},changePassword:function(a,c,d){var e=g.get("authorizationData"),f={Authorization:"Bearer "+e.token};a.Username=e.userName,b.post(h.URL_PATIENTS+"/changepassword",a,{headers:f}).success(function(a){return a=a||"Password changed",console.log("Change password API: "+a),i.show(a,"success",1),c(a)}).error(function(a,b){return a=a||"Request failed",console.log(a,b),i.show(a,"danger",1),d(a,b)})},forgotChangePassword:function(a,c,d){b.post(h.URL_PATIENTS+"/forgotpwdchange",a,h.HEADERS).success(function(a){return a=a||"Password changed",console.log("Forgot comfirm password API: "+a),i.show(a,"success",1),c(a)}).error(function(a,b){return a=a||"Request failed",console.log(a,b),i.show(a,"danger",1),d(a,b)})},forgotPassword:function(a,c,d){var e={Username:a};b.post(h.URL_PATIENTS+"/requestforgotpwd",e).success(function(a){return console.log("Forgot password API: "+a),c(a)}).error(function(a,b){return a=a||"Request failed",console.log(a,b),i.show(a,"danger",1),d(a,b)})},serviceAgreementEmail:function(a,c,d){var e=g.get("authorizationData"),f={Authorization:"Bearer "+e.token};b.post(h.URL_PATIENTS+"/emailserviceagreement",{},{headers:f}).success(function(a){return i.show(a,"success",1),c()}).error(function(){var a="Service Agreement email API error";return i.show(a,"danger",1),d(a)})},healthProfileQuestions:function(a,c,d){var e=g.get("authorizationData"),f={Authorization:"Bearer "+e.token},i=[{id:1,answerOptionId:a.medical_condition},{id:2,answerOptionId:a.last_doctor_visit}];b.post(h.URL_PATIENTS+"/"+a.id+"/healthprofileqna",i,{headers:f}).success(function(){return!0}).error(function(){var a="Onboarding health questions API error";return console.log(a),d(a)})}}}]).factory("Auth",["localStorageService","UserService",function(a,b){function c(b){return angular.extend(f,b),a.set("user",f),f}var d=routingConfig.accessLevels,e=routingConfig.userRoles,f=a.get("user")||{userName:"",role:e.public};return{update:function(a,d,e,f,g){b.save(a,d,e,f),a=c(a),this.user=a,g&&b.healthProfileQuestions(a,d,e)},createAccount:function(c,d,e){function f(a){b.healthProfileQuestions(a,d,e)}b.createAccount(c,f,e),a.remove("tempUser")},setTempAccount:function(b,c,d){if(c){var e=[{id:1,answerOptionId:b.medical_condition},{id:2,answerOptionId:b.last_doctor_visit}];a.set("healthProfileQuestions",e)}return a.set("tempUser",b),d()},getTempUser:function(){return a.get("tempUser")},address:function(a,c,d,e,f,g){b.address(a,c,d,e,f,g)},authorize:function(a,b){return console.log("Current User",f),void 0===b&&(b=f.role),a.bitMask&b.bitMask},loginExpired:function(){var b,c=a.get("authorizationData");if(null===c)b=0;else{var d=new Date,e=new Date(c.login_date),f=1e3*c.expires_in,g=Math.abs(d.getTime()-e.getTime());isNaN(f)&&(f=0,g=1),b=g>f}return b},isLoggedIn:function(a){return void 0===a&&(a=f),a.role.title===e.user.title||a.role.title===e.admin.title},setCurrentAccount:function(a,d,e){function f(a){return c(a),g.user=a,d(a)}var g=this;b.getFullProfile(a,f,e,{role:{bitMask:2,title:"user"}})},isRootAccount:function(b){var c=a.get("authorizationData");return b.id==c.root_id},register:function(a,c,d){b.signup(a,c,d)},login:function(a,d,e){var g=this;b.login(a,function(a){console.log(f),a=c(a),g.user=a,d(a)},e)},needLogin:function(){},logout:function(b){f={},a.remove("authorizationData");var d=c({userName:"",role:e.public});this.user=d,b()},getLoggedinPath:function(){var b=a.get("lastpath");if(null==b)return"/accounts-switcher";var c=a.get("authorizationData"),d=new Date(b.date),e=new Date,f=864e5;return a.remove("lastpath"),f>e-d&&b.id==c.root_id?b.path:"/accounts-switcher"},accessLevels:d,userRoles:e,user:f}}]).factory("authHttpResponseInterceptor",["$q","$location","localStorageService","Notification",function(a,b,c,d){return{response:function(b){return 401===b.status&&console.log("Response 401"),b||a.when(b)},responseError:function(e){if(401===e.status){console.log("Response Error 401",e),d.hide(1),d.show("Session expired, please login again","danger",1);var f=c.get("authorizationData");c.set("lastpath",{id:f.root_id,path:b.path(),date:new Date}),b.path("logout")}return a.reject(e)}}}]);var appFilters=angular.module("appFilters",[]);appFilters.filter("splitTxt",function(){return function(a){return a=a.replace(/_/g," "),-1===a.search("none")?a:"none"}}).filter("getByProperty",function(){return function(a,b,c){for(var d=0,e=a.length;e>d;d++)if(+a[d][b]==+c)return a[d];return null}});